function init(e){e.use(new LocalStrategy({usernameField:"email"},async(e,s,r)=>{const i=await User.findOne({email:e});if(!i)return r(null,!1,{message:"No user with this email"});bcrypt.compare(s,i.password).then(e=>e?r(null,i,{message:"Logged in successfully"}):r(null,!1,{message:" Wrong email or password"})).catch(e=>r(null,!1,{message:"Something went wrong"}))})),e.serializeUser((e,s)=>{s(null,e._id)}),e.deserializeUser((e,s)=>{User.findById(e,(e,r)=>{s(e,r)})})}const LocalStrategy=require("passport-local").Strategy,User=require("../models/user"),bcrypt=require("bcrypt");module.exports=init;